DAILY_TASK_MONSTER_CONFIG = { 
               _maxTasksForPlayer = 6,
			   _maxTasksSameTime = 3,
			   ["Tasks"] = {
                             [1] = { 
			                     name = "Spider",
                                 monsterList = { "Spider", "Poison Spider", "Tarantula" },
		                         minLevel = 1, 
		                         maxLevel = 60,
		                         kills = 50,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 70000 },
						                         { type = "item", itemid = 32771, count = 5 },
												 { type = "item", itemid = 3043, count = 3 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [2] = { 
			                     name = "Skeleton",
                                 monsterList = { "Skeleton", "Skeleton Warrior", "Demon Skeleton" },
		                         minLevel = 1, 
		                         maxLevel = 60,
		                         kills = 100,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 70000 },
						                         { type = "item", itemid = 32771, count = 5 },
												 { type = "item", itemid = 3043, count = 3 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [3] = { 
			                     name = "Cyclop",
                                 monsterList = { "Cyclops", "Cyclops Drone", "Cyclops Smith" },
		                         minLevel = 1, 
		                         maxLevel = 50,
		                         kills = 120,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 65000 },
						                         { type = "item", itemid = 32771, count = 5 },
												 { type = "item", itemid = 3043, count = 3 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [4] = { 
			                     name = "Corym",
                                 monsterList = { "Corym Charlatan", "Corym Skirmisher", "Corym Vanguard" },
		                         minLevel = 20, 
		                         maxLevel = 100,
		                         kills = 150,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 130000 },
						                         { type = "item", itemid = 32771, count = 8 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [5] = { 
			                     name = "Mummy",
                                 monsterList = { "Mummy", "Tomb Servant", "Bonebeast", "Ghoul", "Scarab" },
		                         minLevel = 30,
		                         maxLevel = 100,
		                         kills = 200,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 170000 },
						                         { type = "item", itemid = 32771, count = 8 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [6] = { 
			                     name = "Vampire",
                                 monsterList = { "Vampire Bride", "Vampire", "Vicious Manbat", "Nightfiend" },
		                         minLevel = 50, 
		                         maxLevel = 130,
		                         kills = 200,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 250000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [7] = { 
			                     name = "Putrid Mummy",
                                 monsterList = { "Putrid Mummy" },
		                         minLevel = 50, 
		                         maxLevel = 130,
		                         kills = 150,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 230000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [8] = { 
			                     name = "Dragon",
                                 monsterList = { "Dragon", "Dragon Hatchling" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [9] = { 
			                     name = "Lion",
                                 monsterList = { "Noble Lion", "Roaring Lion", "Lion" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [10] = { 
			                     name = "Forest Fury",
                                 monsterList = { "Forest Fury", "Elder Forest Fury" },
		                         minLevel = 20, 
		                         maxLevel = 100,
		                         kills = 150,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 130000 },
						                         { type = "item", itemid = 32771, count = 8 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [11] = { 
			                     name = "Rotworm",
                                 monsterList = { "Rotworm", "Carrion Worm" },
		                         minLevel = 1, 
		                         maxLevel = 60,
		                         kills = 60,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 50000 },
						                         { type = "item", itemid = 32771, count = 2 },
												 { type = "item", itemid = 3043, count = 1 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [12] = { 
			                     name = "Hero",
                                 monsterList = { "Hero", "Vicious Squire", "Renegade Knight", "Vile Grandmaster", "Midnight Warrior" },
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [13] = { 
			                     name = "Dragon Lord",
                                 monsterList = { "Dragon Lord", "Dragon Lord Hatchling" },
		                         minLevel = 80, 
		                         maxLevel = 250,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[14] = { 
			                     name = "Stampor",
                                 monsterList = { "Stampor", },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[15] = { 
			                     name = "Giant Spider",
                                 monsterList = { "Giant Spider" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[16] = { 
			                     name = "Crystal Spider",
                                 monsterList = { "Crystal Spider" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[17] = { 
			                     name = "Leaf Golem",
                                 monsterList = { "Salamander", "Emerald Damselfly", "Insect Swarm", "Marsh Stalker", "Leaf Golem", "Wilting Leaf Golem"  },
		                         minLevel = 20, 
		                         maxLevel = 100,
		                         kills = 150,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 130000 },
						                         { type = "item", itemid = 32771, count = 8 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[18] = { 
			                     name = "Sea Serpent",
                                 monsterList = { "Sea Serpent", "Young Sea Serpent" },
		                         minLevel = 100, 
		                         maxLevel = 250,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 650000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[19] = { 
			                     name = "Terrorsleep",
                                 monsterList = { "Seacrest Serpent", "Terrorsleep" },
		                         minLevel = 100, 
		                         maxLevel = 250,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1500000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[20] = { 
			                     name = "Black Knight",
                                 monsterList = { "Black Knight" },
		                         minLevel = 100, 
		                         maxLevel = 250,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1500000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[21] = { 
			                     name = "Glooth Bandit",
                                 monsterList = { "Glooth Bandit", "Glooth Brigand" },
		                         minLevel = 100, 
		                         maxLevel = 250,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1500000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[22] = { 
			                     name = "Stonerefiner",
                                 monsterList = { "Stonerefiner" },
		                         minLevel = 30, 
		                         maxLevel = 150,
		                         kills = 200,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 200000 },
						                         { type = "item", itemid = 32771, count = 8 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[23] = { 
			                     name = "Crystalcrusher",
                                 monsterList = { "Crystalcrusher", "Enraged Crystal Golem", "Damaged Crystal Golem" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[24] = { 
			                     name = "Armadile",
                                 monsterList = { "Armadile", "Stone Devourer" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[25] = { 
			                     name = "Exotic Cave Spider",
                                 monsterList = { "Exotic Cave Spider" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[26] = { 
			                     name = "Ogre",
                                 monsterList = { "Ogre Brute", "Ogre Savage", "Ogre Shaman" },
		                         minLevel = 50, 
		                         maxLevel = 150,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 400000 },
						                         { type = "item", itemid = 32771, count = 11 },
												 { type = "item", itemid = 3043, count = 8 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[27] = { 
			                     name = "Ogre Rowdy",
                                 monsterList = { "Ogre Rowdy", "Ogre Ruffian", "Ogre Sage", "Shaper Matriarch" },
		                         minLevel = 150, 
		                         maxLevel = 300,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1500000 },
						                         { type = "item", itemid = 5878, count = 20 },
												 { type = "item", itemid = 3043, count = 15 },
												 { type = "task points", value = 3 },
					                           },
	                            },
							[28] = { 
			                     name = "Yielothax",
                                 monsterList = { "Yielothax" },
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[29] = { 
			                     name = "Cult",
                                 monsterList = { "Dark Apprentice", "Dark Magician", "Acolyte of the Cult", "Adept of the Cult", "Enlightened of the Cult" },
		                         minLevel = 50, 
		                         maxLevel = 130,
		                         kills = 200,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 250000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 5 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[30] = { 
			                     name = "Lost Thrower",
                                 monsterList = { "Lost Thrower", "Lost Basher", "Lost Berserker", "Lost Husher" },
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[31] = { 
			                     name = "Souleater",
                                 monsterList = { "Souleater" },
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[32] = { 
			                     name = "Pirat Cutthroat",
                                 monsterList = { "Pirat Cutthroat", "Pirat Mate", "Pirat Scoundrel", "Pirat Bombardier"},
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[33] = { 
			                     name = "Nightmare",
                                 monsterList = { "Nightmare", "Nightmare Scion" },
		                         minLevel = 80, 
		                         maxLevel = 200,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[34] = { 
			                     name = "Werehyaena",
                                 monsterList = { "Werehyaena", "Werehyaena Shaman" },
		                         minLevel = 90, 
		                         maxLevel = 300,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1000000 },
						                         { type = "item", itemid = 32771, count = 20 },
												 { type = "item", itemid = 3043, count = 15 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[35] = { 
			                     name = "Demon",
                                 monsterList = { "Demon" },
		                         minLevel = 100, 
		                         maxLevel = 6000,
		                         kills = 6666,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 15000000 },
						                         { type = "item", itemid = 32771, count = 100 },
												 { type = "item", itemid = 3043, count = 100 },
												 { type = "item", itemid = 7393, count = 1 },
												 { type = "task points", value = 1 },
					                           },
	                            },

							[36] = { 
			                     name = "Shark",
                                 monsterList = { "Shark" },
		                         minLevel = 0, 
		                         maxLevel = 80,
		                         kills = 300,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 350000 },
						                         { type = "item", itemid = 32771, count = 10 },
												 { type = "item", itemid = 3043, count = 7 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[37] = { 
			                     name = "Hydra",
                                 monsterList = { "Hydra" },
		                         minLevel = 80, 
		                         maxLevel = 250,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[38] = { 
			                     name = "Medusa",
                                 monsterList = { "Medusa", "Serpent Spawn", },
		                         minLevel = 100, 
		                         maxLevel = 400,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2000000 },
						                         { type = "item", itemid = 32771, count = 20 },
												 { type = "item", itemid = 3043, count = 15 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[39] = { 
			                     name = "Cliff Strider",
                                 monsterList = { "Cliff Strider", "Orewalker", "Ironblight" },
		                         minLevel = 150, 
		                         maxLevel = 400,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2500000 },
						                         { type = "item", itemid = 32771, count = 25 },
												 { type = "item", itemid = 3043, count = 18 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[40] = { 
			                     name = "Cave Devourer",
                                 monsterList = { "Cave Devourer", "Arachnophobica", "Bone Bringer" },
		                         minLevel = 100, 
		                         maxLevel = 400,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2000000 },
						                         { type = "item", itemid = 32771, count = 20 },
												 { type = "item", itemid = 3043, count = 15 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[41] = { 
			                     name = "Cobra",
                                 monsterList = { "Cobra Assassin", "Cobra Scout", "Cobra Vizier" },
		                         minLevel = 200, 
		                         maxLevel = 600,
		                         kills = 700,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 4500000 },
						                         { type = "item", itemid = 32771, count = 45 },
												 { type = "item", itemid = 3043, count = 45 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[42] = { 
			                     name = "Tunnel Tyrant",
                                 monsterList = { "Tunnel Tyrant" },
		                         minLevel = 100, 
		                         maxLevel = 400,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2000000 },
						                         { type = "item", itemid = 32771, count = 20 },
												 { type = "item", itemid = 3043, count = 15 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[43] = { 
			                     name = "Defiler",
                                 monsterList = { "Defiler", "Slime", "Devourer"},
		                         minLevel = 100, 
		                         maxLevel = 250,
		                         kills = 500,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 1500000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[44] = { 
			                     name = "Destroyer",
                                 monsterList = { "Destroyer", "Behemoth", "Hellspawn"},
		                         minLevel = 100, 
		                         maxLevel = 300,
		                         kills = 700,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2500000 },
						                         { type = "item", itemid = 32771, count = 25 },
												 { type = "item", itemid = 3043, count = 25 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[45] = { 
			                     name = "Grim Reaper",
                                 monsterList = { "Grim Reaper" },
		                         minLevel = 100, 
		                         maxLevel = 350,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 2500000 },
						                         { type = "item", itemid = 32771, count = 25 },
												 { type = "item", itemid = 3043, count = 25 },
												 { type = "task points", value = 1 },
					                           },
	                            },
						    [46] = { 
			                     name = "Gazer Spectre",
                                 monsterList = { "Gazer Spectre" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[47] = { 
			                     name = "Burster Spectre",
                                 monsterList = { "Burster Spectre" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[48] = { 
			                     name = "Ripper Spectre",
                                 monsterList = { "Ripper Spectre" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[49] = { 
			                     name = "Guzzlemaw",
                                 monsterList = { "Guzzlemaw", "Frazzlemaw" },
		                         minLevel = 200, 
		                         maxLevel = 600,
		                         kills = 700,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 4500000 },
						                         { type = "item", itemid = 32771, count = 45 },
												 { type = "item", itemid = 3043, count = 45 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[50] = { 
			                     name = "Sphinx",
                                 monsterList = { "Sphinx", "Lamassu", "Crypt Warden" },
		                         minLevel = 150, 
		                         maxLevel = 700,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 7000000 },
						                         { type = "item", itemid = 32771, count = 60 },
												 { type = "item", itemid = 3043, count = 60 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[51] = { 
			                     name = "Flimsy",
                                 monsterList = { "Flimsy Lost Soul", "Freakish Lost Soul", "Mean Lost Soul" },
		                         minLevel = 150, 
		                         maxLevel = 700,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 7000000 },
						                         { type = "item", itemid = 32771, count = 60 },
												 { type = "item", itemid = 3043, count = 60 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[52] = { 
			                     name = "Hellflayer",
                                 monsterList = { "Hellflayer" },
		                         minLevel = 200, 
		                         maxLevel = 700,
		                         kills = 700,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 10000000 },
						                         { type = "item", itemid = 32771, count = 75 },
												 { type = "item", itemid = 3043, count = 60 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[53] = { 
			                     name = "Energetic Book",
                                 monsterList = { "Energetic Book", "Energuardian of Tales", "Knowledge Elemental" },
		                         minLevel = 300, 
		                         maxLevel = 1000,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 12000000 },
						                         { type = "item", itemid = 32771, count = 85 },
												 { type = "item", itemid = 3043, count = 65 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[54] = { 
			                     name = "Cursed Book",
                                 monsterList = { "Cursed Book" },
		                         minLevel = 300, 
		                         maxLevel = 1000,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 12000000 },
						                         { type = "item", itemid = 32771, count = 85 },
												 { type = "item", itemid = 3043, count = 65 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[55] = { 
			                     name = "Burning Book",
                                 monsterList = { "Burning Book", "Rage Squid", "Floating Savant" },
		                         minLevel = 300, 
		                         maxLevel = 1000,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 12000000 },
						                         { type = "item", itemid = 32771, count = 85 },
												 { type = "item", itemid = 3043, count = 65 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[56] = { 
			                     name = "Icecold Book",
                                 monsterList = { "Icecold Book", "Animated Feather", "Squid Warden", "Biting Book" },
		                         minLevel = 300, 
		                         maxLevel = 1000,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 12000000 },
						                         { type = "item", itemid = 32771, count = 85 },
												 { type = "item", itemid = 3043, count = 65 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[57] = { 
			                     name = "Rotten Golem",
                                 monsterList = { "Rotten Golem" },
		                         minLevel = 450, 
		                         maxLevel = 1300,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 20000000 },
						                         { type = "item", itemid = 32771, count = 90 },
												 { type = "item", itemid = 3043, count = 75 },
												 { type = "task points", value = 1 },
					                           },
	                            },
						     [58] = { 
			                     name = "Rat",
                                 monsterList = { "Rat", "Cave Rat" },
		                         minLevel = 1, 
		                         maxLevel = 50,
		                         kills = 100,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 30000 },
						                         { type = "item", itemid = 32771, count = 2 },
												 { type = "item", itemid = 3043, count = 2 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							 [59] = { 
			                     name = "Infernal Demon",
                                 monsterList = { "Infernal Demon" },
		                         minLevel = 450, 
		                         maxLevel = 1300,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 20000000 },
						                         { type = "item", itemid = 32771, count = 90 },
												 { type = "item", itemid = 3043, count = 75 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[60] = { 
			                     name = "Brachiodemon",
                                 monsterList = { "Brachiodemon" },
		                         minLevel = 450, 
		                         maxLevel = 1300,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 20000000 },
						                         { type = "item", itemid = 32771, count = 90 },
												 { type = "item", itemid = 3043, count = 75 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[61] = { 
			                     name = "Bony Sea Devil",
                                 monsterList = { "Bony Sea Devil" },
		                         minLevel = 450, 
		                         maxLevel = 1300,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 20000000 },
						                         { type = "item", itemid = 32771, count = 90 },
												 { type = "item", itemid = 3043, count = 75 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[62] = { 
			                     name = "Mould Phantom",
                                 monsterList = { "Mould Phantom", "Vibrant Phantom", "Distorted Phantom" },
		                         minLevel = 450, 
		                         maxLevel = 1300,
		                         kills = 800,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 20000000 },
						                         { type = "item", itemid = 32771, count = 90 },
												 { type = "item", itemid = 3043, count = 75 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							[63] = { 
			                     name = "Spiky Carnivor",
                                 monsterList = { "Spiky Carnivor", "Menacing Carnivor", "Lumbering Carnivor" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
						    [64] = { 
			                     name = "Hellfire Fighter",
                                 monsterList = { "Hellfire Fighter" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
	                            },
                            [65] = { 
			                     name = "Humongous Fungus",
                                 monsterList = { "Humongous Fungus" },
		                         minLevel = 150, 
		                         maxLevel = 450,
		                         kills = 600,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 3000000 },
						                         { type = "item", itemid = 32771, count = 35 },
												 { type = "item", itemid = 3043, count = 30 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							},
							[66] = { 
			                     name = "Lizard Chosen",
                                 monsterList = { "Lizard Chosen" },
		                         minLevel = 80, 
		                         maxLevel = 250,
		                         kills = 400,
					             increaseDificulty = {
					                                   ["medium"] = 0.9,
										               ["hard"] = 1.6,
										             },
		                         ["Rewards"] = { 
		                                         { type = "experience", value = 700000 },
						                         { type = "item", itemid = 32771, count = 15 },
												 { type = "item", itemid = 3043, count = 10 },
												 { type = "task points", value = 1 },
					                           },
	                            },
							},
				["Mission Bonuses"] = {	
				                        [1] = {
										        name = "Play with fire",
												monsterList = { 
												                [1] = { name = "Fire Devil", kills = 2500 },
																[2] = { name = "Fire Elemental", kills = 2500 },
																[3] = { name = "Demon", kills = 1000 },
																[4] = { name = "Orshabaal", kills = 1 },
																[5] = { name = "Morgaroth", kills = 1 },
															  },
												["Required"] = {
												                 { type = "task points", value = 100 },
															   },
												["Rewards"] = {
												                { type = "hppc", value = 3 },
																{ type = "mppc", value = 3 },
                                                              },															   
											  },
											  
				                        [2] = {
										        name = "Into the Deep Sea",
												monsterList = { 
												                [1] = { name = "Deepling Tyrant", kills = 2500 },
																[2] = { name = "Deepling Spellsinger", kills = 2500 },
																[3] = { name = "Jaul", kills = 1 },
																[4] = { name = "Tanjis", kills = 1 },
															  },
												["Required"] = {
												                 { type = "task points", value = 150 },
															   },
												["Rewards"] = {
																{ type = "resistall", value = 5 },
                                                              },																
											  },
				                        [3] = {
										        name = "Angry Monkeys",
												monsterList = { 
												                [1] = { name = "Merlkin", kills = 2500 },
																[2] = { name = "Kongra", kills = 2500 },
																[3] = { name = "Dworc Voodoomaster", kills = 2500 },
															  },
												["Required"] = {
												                 { type = "task points", value = 250 },
															   },
												["Rewards"] = {
																{ type = "healing", value = 5 },
                                                              },																
											  },											  
									  }
}

DAILY_TASK_MONSTER_CONFIG.storages = {
  countTask = 21000,
  maxTasks = 21001,
  getKills = 21002,
  tracker = 25344,
  tracker2 = 27345,
  ["Dificults"] = {
                    ["easy"] = 22000,
                    ["medium"] = 23000,
                    ["hard"] = 24000,
				  },
  ["Bonus"] = {
                getKills = 25345,
				missionId = 45345,
				monsters = 55345,
			  },
                  
}




DAILY_TASK_MONSTER_SYSTEM = {}
BONUS_TASK_MONSTER_SYSTEM = {}

DIFICULT_EASY = 1
DIFICULT_MEDIUM = 2
DIFICULT_HARD = 3

TASK_PROGRESS = 1
TASK_REPORT = 2
TASK_FINISHED = 3
TASK_CANCELED = 4


BONUS_NOT_SELECTED = 0
BONUS_PAY = 1
BONUS_SELECTED = 2
BONUS_READY_TO_FINISH = 3
BONUS_FINISHED = 4




function Player.getDailyTaskPoints(self)
	resultId = db.storeQuery("SELECT `daily_task_points` FROM `players` WHERE `id` = " .. self:getGuid())
	if not resultId then return 0 end
	return result.getDataInt(resultId, "daily_task_points")
end

function Player.setDailyTaskPoints(self, coins)
	db.query("UPDATE `players` SET `daily_task_points` = " .. coins .. " WHERE `id` = " .. self:getGuid())
	return true
end

function firstToUpper(str)
    return (str:gsub("^%l", string.upper))
end

local function prepareDaily()
    
	local questIndex = 1
	while true do
		if (not Quests[questIndex]) then
			Quests[questIndex] = {
		      name = "Daily Tasks",
		      startStorageId = DAILY_TASK_MONSTER_CONFIG.storages.tracker,
              startStorageValue = 1,
			  missions = {}
			}
			break
		end
		questIndex = questIndex + 1
	end
		
	local t = DAILY_TASK_MONSTER_CONFIG["Tasks"]
	for i = 1, #t do
		for dificult, v in pairs(DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]) do
		local values = {
		                name = "[" .. firstToUpper(dificult) .. "]" .. " " .. t[i].name,
		                storageId = v + i,
			            missionId = v + i,
			            startValue = 1,
			            endValue = 4,
						states = {
					             [1] = function(player)
								       local kills = DAILY_TASK_MONSTER_SYSTEM:getRequiredKills(player, i, dificult)
					                   local playerKills = DAILY_TASK_MONSTER_SYSTEM:getKillsProgress(player, i)
					                   if playerKills < 0 then
					                      playerKills = 0
				                       end  
					                   local monsterList = t[i].monsterList
					                   local list = ""
					                   for i = 1, #monsterList do
					                       if i == #monsterList then
						                      list = list .. monsterList[i]:lower() .. "."
							               else
							                  list = list .. monsterList[i]:lower() .. ", "
						                   end
					                   end
									   return string.format("You have to kill " .. t[i].name .. "s." .. "\n" .. "Avaible Monsters: " .. list .. "\n" .. "Monsters Left: " .. playerKills)
									   end,
								 [2] = "Hunting is finished, back to npc to receive a reward.",
								 [3] = "Task is completed.",
								 [4] = "Task is canceled."
							   }
					   }
					   table.insert(Quests[questIndex].missions, values)
			end
	end
end
	
local function prepareBonus()
    
	local questIndex = 1
	while true do
		if (not Quests[questIndex]) then
			Quests[questIndex] = {
		      name = "Hidden Tasks",
		      startStorageId = DAILY_TASK_MONSTER_CONFIG.storages.tracker2,
              startStorageValue = 1,
			  missions = {}
			}
			break
		end
		questIndex = questIndex + 1
	end
	
	t = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"]
	for i = 1, #t do
	    local bonusTable = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].missionId
	    local values = {
		                 name = t[i].name,
						 storageId = bonusTable + i,
			             missionId = bonusTable + i,
			             startValue = 2,
			             endValue = 4,
						 states = {
					             [2] = function(player)
									   return "You have to kill " .. BONUS_TASK_MONSTER_SYSTEM:getRequiredKillsString(player, i)
									   end,
								 [3] = "Hunting is finished, back to npc to receive a reward.",
								 [4] = "Task is completed."
							   }
					   }
	    table.insert(Quests[questIndex].missions, values)
    end
end

function BONUS_TASK_MONSTER_SYSTEM:setQuestLogMission(player, index, value)
      
	  if not player then
	     print("PLAYER NOT FOUND")
	     return nil
	  end
	  
	  if not value then
	     print("VALUE NOT FOUND")
		 return nil
	  end
	  
	  if not index then
	     print("INDEX NOT FOUND")
		 return nil
	  end
	  
	  local isStarted = player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.tracker2)
	  if isStarted < 1 and value > 0 then
	     player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.tracker2, 1) 
      end
	
	  
	player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].missionId + index, value)
end

function BONUS_TASK_MONSTER_SYSTEM:getQuestLogMission(player, index)
      
	  if not player then
	     return nil
	  end
	  
	  if not index then
	     print("INDEX NOT FOUND")
		 return nil
	  end
	  
	  local value = player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].missionId + index)
	  
	  if value < 1 then
	     value = 0
	  end
	  
	  return value
end
	
function BONUS_TASK_MONSTER_SYSTEM:setRequiredKills(player, index)
    
	local t = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"][index]
	local monsterList = t.monsterList
	
	for i = 1, #monsterList do
	    local kills = monsterList[i].kills
		local key = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].getKills + i
		player:setStorageValue(key, kills)
    end
end

function BONUS_TASK_MONSTER_SYSTEM:getRequiredKills(player, index)
   local t = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].getKills + index
   local value = player:getStorageValue(t)
   if value < 0 then
      value = 0
   end
   return value
end

function BONUS_TASK_MONSTER_SYSTEM:isHuntingFinished(player, missionid)
   
   local finished = false
   local t = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"][missionid]
   local monsterList = t.monsterList
   for i = 1, #monsterList do
       local key = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].getKills + i
       if player:getStorageValue(key) > 0 then
	      return false
	   end
   end
   return true
end
	  
function BONUS_TASK_MONSTER_SYSTEM:addKills(player, missionid, index)

   if BONUS_TASK_MONSTER_SYSTEM:getQuestLogMission(player, missionid) ~= BONUS_SELECTED then
      return false
   end
   
   local t = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].getKills + index
   local value = BONUS_TASK_MONSTER_SYSTEM:getRequiredKills(player, index)
   player:setStorageValue(t, value - 1)
   value = BONUS_TASK_MONSTER_SYSTEM:getRequiredKills(player, index)
   
   
   local key = DAILY_TASK_MONSTER_CONFIG.storages["Bonus"].missionId + missionid
   DAILY_TASK_MONSTER_SYSTEM:updateTracker(player, key)
   
   if value == 0 then
      if BONUS_TASK_MONSTER_SYSTEM:isHuntingFinished(player, missionid) then
         if BONUS_TASK_MONSTER_SYSTEM:getQuestLogMission(player, missionid) == BONUS_SELECTED then
	        BONUS_TASK_MONSTER_SYSTEM:setQuestLogMission(player, missionid, BONUS_READY_TO_FINISH)
         end
	   end
   end
   


end

function BONUS_TASK_MONSTER_SYSTEM:getCurrentMission(player)
    
	local t = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"]

	for i = 1, #t do
	    if BONUS_TASK_MONSTER_SYSTEM:getQuestLogMission(player, i) < BONUS_FINISHED then
		   return i
	   end
	end

	return false
end
	    
function BONUS_TASK_MONSTER_SYSTEM:updateTask(player, creature)
   
   local name = creature:getName()
   local missionid = BONUS_TASK_MONSTER_SYSTEM:getCurrentMission(player)
      
   
   if not missionid then
      return false
   end
   
   if BONUS_TASK_MONSTER_SYSTEM:getQuestLogMission(player, missionid) ~= BONUS_SELECTED then
      return false
   end
   
   local monsterList = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"][missionid].monsterList
   for i,v in pairs(monsterList) do
       if v.name:lower() == name:lower() then
	      return BONUS_TASK_MONSTER_SYSTEM:addKills(player, missionid, i)
	   end
   end
  
end

function BONUS_TASK_MONSTER_SYSTEM:getRequiredKillsString(player, missionid, fromTable)
   
   local str = ""
   
   local t = DAILY_TASK_MONSTER_CONFIG["Mission Bonuses"][missionid]
   local monsterList = t.monsterList
   
   for i = 1, #monsterList do
       local name = monsterList[i].name
	   local kills = nil
	   if fromTable then
         kills = monsterList[i].kills
	   else
	     kills = BONUS_TASK_MONSTER_SYSTEM:getRequiredKills(player, i)
	   end
	   if kills > 0 then
	      if i == #monsterList then
		     str = str .. kills .. " " .. name .. "."
		  else
		     str = str .. kills .. " " .. name .. ", "
		  end
	  end
	end
	   
   return str
   
end  
	
function DAILY_TASK_MONSTER_SYSTEM:getRequiredKills(player, index, dificult)
   	local t = DAILY_TASK_MONSTER_CONFIG["Tasks"][index]
    local kills = t.kills
    if dificult == "easy" then
	   return math.ceil(kills)
    elseif dificult == "medium" then
       local multipiler = t.increaseDificulty["medium"]
	   kills = kills + (kills * multipiler)
	   return math.ceil(kills)	
    elseif dificult == "hard" then
       local multipiler = t.increaseDificulty["hard"]
	   kills = kills + (kills * multipiler)
	   return math.ceil(kills)
	end
	return 0
end

function DAILY_TASK_MONSTER_SYSTEM:getAvaibleTaskList(player)
    
	local taskList = "Alright, here is a list of avaible tasks for you "
	local t = DAILY_TASK_MONSTER_CONFIG["Tasks"]
	local _isEmpty = true
	for i = 1, #t do
	   local name = t[i].name
	   local minLevel = t[i].minLevel
	   local maxLevel = t[i].maxLevel
	   local level = player:getLevel()
	   if level >= minLevel and level <= maxLevel then
	   	   if i == #t then
			  --taskList = taskList .. "{" .. name ..  " Task" .. "}" .. "."
			  taskList = taskList .. "{" .. name .. "}" .. "."
		   else
		      --taskList = taskList .. "{" .. name .. " Task" .. "}" .. ", "
			  taskList = taskList .. "{" .. name .. "}" .. ", "
		   end
		   if _isEmpty then
		      _isEmpty = false
		   end
	   end
	end
	
	if _isEmpty then
	   return false
	end
	return taskList
end

function DAILY_TASK_MONSTER_SYSTEM:reachedSameTimeLimit(player)

    if player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.maxTasks) >= DAILY_TASK_MONSTER_CONFIG._maxTasksSameTime then
	   return true
	end
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:reachedDailyLimit(player, index, dificult)

	if player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask) >= DAILY_TASK_MONSTER_CONFIG._maxTasksForPlayer then
	   if not DAILY_TASK_MONSTER_SYSTEM:isOtherDificultFinished(player, index, dificult) then
	      return true
	   end
    end
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:setSameTimeLimit(player, bool)
    local storageValue = player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.maxTasks)
	if storageValue < 0 then
	   storageValue = 0
	end
	
	if bool then
	   return player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.maxTasks, storageValue + 1)
	else
	   return player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.maxTasks, storageValue - 1)
	end
end


function Player.testo(self, mission)


	local msg = NetworkMessage()
	msg:addByte(0xD0)
	msg:addByte(0x00)
	msg:addU16(mission.missionId)
	msg:sendToPlayer(self)
	msg:delete()
end


function DAILY_TASK_MONSTER_SYSTEM:setTaskProgress(player, index, dificult, value)
    
	
	if value == TASK_CANCELED then
	   player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask, player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask - 1))
	   DAILY_TASK_MONSTER_SYSTEM:setSameTimeLimit(player, false)
	   
	   
	   local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"][dificult] + index
	   player:setStorageValue(t, -1)	   
	   DAILY_TASK_MONSTER_SYSTEM:updateTracker(player, t)
	   
	   return true
	end
	   
    if value == TASK_PROGRESS then
	   if player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.tracker) < 1 then
	      player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.tracker, 1)
	   end
       -- if not DAILY_TASK_MONSTER_SYSTEM:isOtherDificultFinished(player, index, dificult) then
	      -- player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask, player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask + 1))
	   -- end
	   DAILY_TASK_MONSTER_SYSTEM:setSameTimeLimit(player, true)
    elseif value == TASK_FINISHED then
	   if not DAILY_TASK_MONSTER_SYSTEM:isOtherDificultFinished(player, index, dificult) then
	      player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask, player:getStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.countTask + 1))
	   end
	   DAILY_TASK_MONSTER_SYSTEM:setSameTimeLimit(player, false)
	end

	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"][dificult] + index
	player:setStorageValue(t, value)
	
end
	
function DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, dificult)	
	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"][dificult] + index
	local value = player:getStorageValue(t)
	
	
	if value <= 0 then
	   return "not set"
	elseif value == 1 then 
	   return "progress"
	elseif value == 2 then 
	   return "report"	   
	elseif value == 3 then
	   return "finished"
	   
	end
end

function DAILY_TASK_MONSTER_SYSTEM:isOtherDificultStarted(player, index, dificult)
    
	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]
    for i, v in pairs(t) do
       if i ~= dificult then
	      if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "progress" then
		     return i
		  end
	   end
	end
	
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:isOtherDificultFinished(player, index, dificult)
    
	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]
    for i, v in pairs(t) do
       if i ~= dificult then
	      if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "finished" or DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "report" then
		     return i
		  end
	   end
	end
	
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:isTaskStarted(player, index)
    
	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]
    for i, v in pairs(t) do
	      local status = DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i)
	      if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "progress" or DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "report" then
		     return i
		  end
	end	
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:isAnyDificultStarted(player, index)
    
	local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]
    for i, v in pairs(t) do
	      if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "finished" or DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "report" then
		     return i
		  end
	end	
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:getKillsProgress(player, index)
   
   local t = DAILY_TASK_MONSTER_CONFIG.storages.getKills + index
   local value = player:getStorageValue(t)
   
   if value < 0 then
      value = 0
   end
   
   return value
end

function DAILY_TASK_MONSTER_SYSTEM:setKillsProgress(player, index, value)
   local t = DAILY_TASK_MONSTER_CONFIG.storages.getKills + index
   player:setStorageValue(t, value)
end

function DAILY_TASK_MONSTER_SYSTEM:getIndexByName(name)
	for i, v in ipairs(DAILY_TASK_MONSTER_CONFIG["Tasks"]) do
	    local monsterList = v.monsterList
		if isInArray(monsterList, name) or isInArray(monsterList, name:lower()) or name == v.name or name:lower() == v.name:lower() then
		   return i
		end
		-- for z, d in pairs(monsterList) do
		    -- if d:lower() == name:lower() then
			   -- return i
			-- end
		-- end
	end
	return false
end

function DAILY_TASK_MONSTER_SYSTEM:getTableByName(name)
	for i, v in ipairs(DAILY_TASK_MONSTER_CONFIG["Tasks"]) do
	    local monsterList = v.monsterList
		if isInArray(monsterList, name) or isInArray(monsterList, name:lower()) or name == v.name or name:lower() == v.name:lower() then
		   return v
		end
		-- for z, d in pairs(monsterList) do
		    -- if d:lower() == name:lower() then
			   -- return i
			-- end
		-- end
	end
	return false
end


function DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, index)
    local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]
    for i, v in pairs(t) do
	    if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "progress" or DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, i) == "report" then
		     return i
		end
	end
	
	return false
end
	 
function DAILY_TASK_MONSTER_SYSTEM:isReadyToFinish(player, name)
     
	local index = DAILY_TASK_MONSTER_SYSTEM:getIndexByName(name)
	
    if DAILY_TASK_MONSTER_SYSTEM:getKillsFinish(player, index) then
	   return true
	end
	return false
end
			   		
function DAILY_TASK_MONSTER_SYSTEM:addKillsProgress(player, index)
   local t = DAILY_TASK_MONSTER_CONFIG.storages.getKills + index
   local value = player:getStorageValue(t)
   player:setStorageValue(t, value -1)
   value = player:getStorageValue(t)
   
   local dificult = DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, index)
   local t = DAILY_TASK_MONSTER_CONFIG.storages["Dificults"][dificult] + index
   DAILY_TASK_MONSTER_SYSTEM:updateTracker(player, t)   
   if value <= 0 then
      if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, index, dificult) == "progress" then
	     DAILY_TASK_MONSTER_SYSTEM:setTaskProgress(player, index, dificult, TASK_REPORT)
	  end
   end

end
   
function DAILY_TASK_MONSTER_SYSTEM:setKillsFinish(player, index)
   local t = DAILY_TASK_MONSTER_CONFIG.storages.getKills + index
   return player:setStorageValue(t, -2)
end

function DAILY_TASK_MONSTER_SYSTEM:getKillsFinish(player, index)
   local t = DAILY_TASK_MONSTER_CONFIG.storages.getKills + index
   local value = player:getStorageValue(t)
   if value == -2 then
      return true
   end
   return false
end

function firstToUpper(str)
    return (str:gsub("^%l", string.upper))
end


function DAILY_TASK_MONSTER_SYSTEM:updateTask(player, creature, killer)
   
	local name = creature:getName()
	local index = DAILY_TASK_MONSTER_SYSTEM:getIndexByName(name)
	
	if not index then
	   return false
	end
	
	if not DAILY_TASK_MONSTER_SYSTEM:isTaskStarted(player, index) then
	   return false
	end
	
	if DAILY_TASK_MONSTER_SYSTEM:isReadyToFinish(player, name) then
	    return false
	end
	
	DAILY_TASK_MONSTER_SYSTEM:addKillsProgress(player, index)
	
	local dificult = DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, index)
	local t = DAILY_TASK_MONSTER_SYSTEM:getTableByName(name)
 
	local required = DAILY_TASK_MONSTER_SYSTEM:getRequiredKills(player, index, dificult)
	local left = DAILY_TASK_MONSTER_SYSTEM:getKillsProgress(player, index)
 
	-- if left > 0 then
		-- player:openChannel(19)
		-- sendChannelMessage(19, TALKTYPE_CHANNEL_R1, "[Daily Task]" .. " - " .. "[" .. firstToUpper(dificult) .. "]" .. " - " .. "[" .. t.name .. "]" .. " " .. " - Monsters left: " .. left .. "/" .. required)
 
		-- -- player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "[Daily Task]" .. " - " .. "[" .. firstToUpper(dificult) .. "]" .. " - " .. "[" .. t.name .. "]" .. " " .. " - Monsters left: " .. left .. "/" .. required)
		-- --player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "[Daily Task] - [Hard] - Demons 6/666")
	-- end
	
	
	

	if left == 0 then
		player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "[Daily Task] Congratulations! You have completed the task: " .. t.name .. ".")
		return true
	end
	
	local channelId = 25
	
	player:openChannel(channelId)
		--sendChannelMessage(19, TALKTYPE_CHANNEL_R1, "[Daily Task]" .. " - " .. "[" .. firstToUpper(dificult) .. "]" .. " - " .. "[" .. t.name .. "]" .. " " .. " - Monsters left: " .. left .. "/" .. required)
	player:sendChannelMessage("[Task System]", "[Daily Task]" .. " - " .. "[" .. firstToUpper(dificult) .. "]" .. " - " .. "[" .. t.name .. "]" .. " " .. " - Monsters left: " .. left .. "/" .. required, TALKTYPE_CHANNEL_R1, channelId)
	local pos = creature:getPosition()
		--creature:say(text[, type = TALKTYPE_MONSTER_SAY[, ghost = false[, target = nullptr[, position]]]])
		
	player:say("Monster Killed: " .. left .. "/" .. required, TALKTYPE_MONSTER_SAY, true, false, pos)

	
	-- if killer then
		-- local left = DAILY_TASK_MONSTER_SYSTEM:getKillsProgress(killer, index)
		-- local required = DAILY_TASK_MONSTER_SYSTEM:getRequiredKills(player, index, dificult)
		-- local pos = creature:getPosition()
		-- if left >= 0 then
			-- Game.sendTextOnPosition("Monster Killed: " .. left .. "/" .. required, pos)
		-- end
	-- end
	
end
 

function DAILY_TASK_MONSTER_SYSTEM:getRewardTable(player, index)
    
	local dificult = DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, index)
	
	local increase = DAILY_TASK_MONSTER_CONFIG["Tasks"][index].increaseDificulty[dificult]
	if not increase then
	   return DAILY_TASK_MONSTER_CONFIG["Tasks"][index]["Rewards"]
	end
		
	local t = {}
	for i, v in pairs(DAILY_TASK_MONSTER_CONFIG["Tasks"][index]["Rewards"]) do
	    if v.value then
		   v.value = math.ceil(v.value + (v.value * increase))
		end
	    if v.count then
		   v.count = math.ceil(v.count + (v.count * increase))
		end		
	    if v.money then
		   v.money = math.ceil(v.money + (v.money * increase))
		end	
        t[#t + 1] = v	
    end	
    return t
end

function DAILY_TASK_MONSTER_SYSTEM:updateTracker(player, key, logg)

	local missions = player:getMissionsData(key)
	for i = 1, #missions do
		local mission = missions[i]
		if player:hasTrackingQuest(mission.missionId) then
		   player:sendUpdateTrackedQuest(mission)
		   --player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "Your questlog has been updated.")
		end
	end
    --player:resetTrackedMissions(missions)
end

function DAILY_TASK_MONSTER_SYSTEM:getActiveTasks(player)
	local taskTable = {}
	local str = ""
    local t = DAILY_TASK_MONSTER_CONFIG["Tasks"]
	local begin = true
    for i, v in ipairs(t) do
	    local difficult = DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, i)
		if difficult then
		   if not begin then
		      str = str .. ", "
		   end
		   if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, i, difficult) == "progress" then
		      local name = "{" .. v.name .. "}"
			  str = str .. name
			  begin = false
		   end
		end
    end
	if begin then
	   return false
	end
	str = str .. "." 
	return str
end

function DAILY_TASK_MONSTER_SYSTEM:restartTasks(player)
    local t = DAILY_TASK_MONSTER_CONFIG["Tasks"]
	-- player:setStorageValue(DAILY_TASK_MONSTER_CONFIG.storages.tracker, -1)
	-- for i, v in ipairs(t) do
	    -- for z, b in pairs(DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]) do
		    
	
	for i, v in pairs(DAILY_TASK_MONSTER_CONFIG.storages["Dificults"]) do
	    for z, b in ipairs(t) do
		    if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, z, i) ~= "progress" then
		       DAILY_TASK_MONSTER_SYSTEM:setTaskProgress(player, z, i, TASK_CANCELED)
			end
		end
	end
end
	
	    
	
   
function DAILY_TASK_MONSTER_SYSTEM:getFinishableTasks(player)
	local taskTable = {}
	local str = ""
    local t = DAILY_TASK_MONSTER_CONFIG["Tasks"]
	local begin = true
    for i, v in ipairs(t) do
	    local difficult = DAILY_TASK_MONSTER_SYSTEM:getDificultSelected(player, i)
		if difficult then
		   if not begin then
		      str = str .. ", "
		   end
		   if DAILY_TASK_MONSTER_SYSTEM:getTaskInfoProgress(player, i, difficult) == "report" then
		      local name = "{" .. v.name .. "}"
			  str = str .. name
			  begin = false
		   end
		end
    end
	if begin then
	   return false
	end
	str = str .. "." 
	return str
end


local function processRestart()	
	if DAILY_TASK_MONSTER_SYSTEM.dailyRestarted then
	    return true
	end
	
	--local configTime = getConfigInfo('dailyTaskRestart')
	
	local configTime = "12:26"
	configTime = configTime:gsub(":", "")
	configTime = tonumber(configTime)
	
	local currentTime = os.date("%H:%M")
	currentTime = currentTime:gsub(":", "")
	currentTime = tonumber(currentTime)
	
	
	if currentTime >= configTime then
	    local players = Game.getPlayers()
	    for _, player in ipairs(players) do
	        DAILY_TASK_MONSTER_SYSTEM:restartTasks(player)
	    end
	    Game.broadcastMessage("Daily Tasks has been restarted.", MESSAGE_GAME_HIGHLIGHT)
		DAILY_TASK_MONSTER_SYSTEM.dailyRestarted = true
	    return true
	end
	
	addEvent(processRestart, 10000)
	
	
end
	
	
	


local creaturescript = CreatureEvent("DAILY_TASK_MONSTER_SYSTEM_onDeath")
function creaturescript.onDeath(creature, corpse, killer, mostDamage, unjustified, mostDamage_unjustified)	

    if not creature:isMonster() then
        return false
    end
	
    if creature:getMaster() ~= nil then
        return false
    end
	
    local player = Player(mostDamage)
	if not player then
	   return false
	end
	
	local party = player:getParty() 
	if party then
	   if party:isSharedExperienceEnabled() then
	      local members = party:getMembers()
		  if members then
			 for _, member in pairs(members) do
				DAILY_TASK_MONSTER_SYSTEM:updateTask(member, creature, killer)
			 end
		  end
		  local leader = party:getLeader() 
		  if leader then
		     DAILY_TASK_MONSTER_SYSTEM:updateTask(leader, creature, killer) 
		  end
	   return true
	   end
	end

	
	DAILY_TASK_MONSTER_SYSTEM:updateTask(player, creature, killer)
	return true
end
creaturescript:register()


creaturescript = CreatureEvent("BONUS_TASK_MONSTER_SYSTEM_onDeath")
function creaturescript.onDeath(creature, corpse, killer, mostDamage, unjustified, mostDamage_unjustified)	
    
    if not creature:isMonster() then
        return false
    end
	
    if creature:getMaster() ~= nil then
        return false
    end
	
    local player = Player(mostDamage)
	if not player then
	   return false
	end
	
	local party = player:getParty() 
	if party then
	   if party:isSharedExperienceEnabled() then
	      local members = party:getMembers()
		  if members then
			 for _, member in pairs(members) do
				BONUS_TASK_MONSTER_SYSTEM:updateTask(member, creature)
			 end
		  end
		  local leader = party:getLeader() 
		  if leader then
		     BONUS_TASK_MONSTER_SYSTEM:updateTask(leader, creature) 
		  end
	   return true
	   end
	end
	
	BONUS_TASK_MONSTER_SYSTEM:updateTask(player, creature)
	return true
end
creaturescript:register()

local globalevent = GlobalEvent("load_DAILY_TASK_MONSTER_SYSTEM")
function globalevent.onStartup()
	prepareDaily()
	prepareBonus()
	--processRestart()
end
globalevent:register()


if not DAILY_TASK_MONSTER_SYSTEM.restarted then
    DAILY_TASK_MONSTER_SYSTEM.restarted = "not set"
end


local test = TalkAction("!dailyreset")
function test.onSay(player, words, param)
	--print("Reset Daily - for player " .. player:getName())
    DAILY_TASK_MONSTER_SYSTEM:restartTasks(player)
	
	--processRestart()
	
	-- player:setSkillLevel(SKILL_FIST, 20)
	
	--player:setSkillLevel(skillType, level[, tries])
	
end
test:register()






-- globalevent = GlobalEvent("restart_DAILY_TASK_MONSTER_SYSTEM")
-- function globalevent.onTime(interval)
	-- local players = Game.getPlayers()
	-- for _, player in ipairs(players) do
	    -- DAILY_TASK_MONSTER_SYSTEM:restartTasks(player)
	-- end
	-- Game.broadcastMessage("Daily Tasks has been restarted.", MESSAGE_GAME_HIGHLIGHT)
-- end
-- globalevent:time(getConfigInfo('dailyTaskRestart'))
-- globalevent:register()






   


